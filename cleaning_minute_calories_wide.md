Minute Calories Wide
================

## Load libraries and set current working directory

You can include R code in the document as follows:

``` r
library(tidyverse)
```

    ## -- Attaching packages --------------------------------------- tidyverse 1.3.1 --

    ## v ggplot2 3.3.5     v purrr   0.3.4
    ## v tibble  3.1.4     v dplyr   1.0.7
    ## v tidyr   1.1.3     v stringr 1.4.0
    ## v readr   2.0.2     v forcats 0.5.1

    ## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
    ## x dplyr::filter() masks stats::filter()
    ## x dplyr::lag()    masks stats::lag()

``` r
library(readr)
library(filesstrings)
```

    ## 
    ## Attaching package: 'filesstrings'

    ## The following object is masked from 'package:dplyr':
    ## 
    ##     all_equal

``` r
library(lubridate)
```

    ## 
    ## Attaching package: 'lubridate'

    ## The following objects are masked from 'package:base':
    ## 
    ##     date, intersect, setdiff, union

``` r
library(gapminder)
library(dplyr)

setwd("D:/Projects/Bellabeat/data_cleaning")

input_file <- "D:/Projects/Bellabeat/original_data/minuteCaloriesWide_merged.csv"

cleaned_data_path <- "D:/Projects/Bellabeat/cleaned_data"

output_file <- "minute_calories_wide.csv"
```

## Read file and formatting

``` r
minitue_calories <- read_csv(input_file)
```

    ## Rows: 21645 Columns: 62

    ## -- Column specification --------------------------------------------------------
    ## Delimiter: ","
    ## chr  (1): ActivityHour
    ## dbl (61): Id, Calories00, Calories01, Calories02, Calories03, Calories04, Ca...

    ## 
    ## i Use `spec()` to retrieve the full column specification for this data.
    ## i Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
glimpse(minitue_calories)
```

    ## Rows: 21,645
    ## Columns: 62
    ## $ Id           <dbl> 1503960366, 1503960366, 1503960366, 1503960366, 150396036~
    ## $ ActivityHour <chr> "4/13/2016 12:00:00 AM", "4/13/2016 1:00:00 AM", "4/13/20~
    ## $ Calories00   <dbl> 1.8876, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0~
    ## $ Calories01   <dbl> 2.2022, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0~
    ## $ Calories02   <dbl> 0.9438, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0~
    ## $ Calories03   <dbl> 0.9438, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0~
    ## $ Calories04   <dbl> 0.9438, 0.9438, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0~
    ## $ Calories05   <dbl> 2.0449, 0.9438, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0~
    ## $ Calories06   <dbl> 0.9438, 0.9438, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0~
    ## $ Calories07   <dbl> 2.2022, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0~
    ## $ Calories08   <dbl> 0.9438, 0.9438, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0~
    ## $ Calories09   <dbl> 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0~
    ## $ Calories10   <dbl> 0.9438, 0.9438, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0~
    ## $ Calories11   <dbl> 0.78650, 0.78650, 0.78650, 2.04490, 0.78650, 0.78650, 0.7~
    ## $ Calories12   <dbl> 0.78650, 0.94380, 0.78650, 0.94380, 0.78650, 0.78650, 0.7~
    ## $ Calories13   <dbl> 0.78650, 0.78650, 0.78650, 0.78650, 0.78650, 0.78650, 0.7~
    ## $ Calories14   <dbl> 0.78650, 0.78650, 0.78650, 0.78650, 0.78650, 0.78650, 0.7~
    ## $ Calories15   <dbl> 0.9438, 0.7865, 0.7865, 0.9438, 0.7865, 0.7865, 0.7865, 0~
    ## $ Calories16   <dbl> 0.9438, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0~
    ## $ Calories17   <dbl> 0.7865, 0.7865, 0.7865, 0.9438, 0.7865, 0.7865, 0.7865, 0~
    ## $ Calories18   <dbl> 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0~
    ## $ Calories19   <dbl> 0.7865, 0.7865, 0.7865, 0.7865, 0.9438, 0.9438, 0.7865, 0~
    ## $ Calories20   <dbl> 1.88760, 0.78650, 0.78650, 0.78650, 0.78650, 0.78650, 0.7~
    ## $ Calories21   <dbl> 0.94380, 0.78650, 0.78650, 0.78650, 0.78650, 0.78650, 0.7~
    ## $ Calories22   <dbl> 0.94380, 0.78650, 0.78650, 0.78650, 0.78650, 0.78650, 0.7~
    ## $ Calories23   <dbl> 0.9438, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0~
    ## $ Calories24   <dbl> 0.9438, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0~
    ## $ Calories25   <dbl> 2.0449, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 2~
    ## $ Calories26   <dbl> 2.3595, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 2~
    ## $ Calories27   <dbl> 0.9438, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0~
    ## $ Calories28   <dbl> 2.0449, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0~
    ## $ Calories29   <dbl> 0.9438, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0~
    ## $ Calories30   <dbl> 0.9438, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0~
    ## $ Calories31   <dbl> 0.9438, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 2~
    ## $ Calories32   <dbl> 2.0449, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0~
    ## $ Calories33   <dbl> 1.8876, 0.7865, 0.7865, 0.9438, 0.7865, 0.7865, 0.7865, 0~
    ## $ Calories34   <dbl> 0.9438, 0.7865, 0.7865, 2.0449, 0.7865, 0.7865, 0.7865, 0~
    ## $ Calories35   <dbl> 0.7865, 0.7865, 0.7865, 2.0449, 0.7865, 0.7865, 0.7865, 0~
    ## $ Calories36   <dbl> 0.7865, 0.7865, 0.7865, 1.8876, 0.7865, 0.7865, 0.7865, 0~
    ## $ Calories37   <dbl> 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0~
    ## $ Calories38   <dbl> 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0~
    ## $ Calories39   <dbl> 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0~
    ## $ Calories40   <dbl> 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.9438, 0~
    ## $ Calories41   <dbl> 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.9438, 2~
    ## $ Calories42   <dbl> 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 2~
    ## $ Calories43   <dbl> 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.9438, 0~
    ## $ Calories44   <dbl> 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0~
    ## $ Calories45   <dbl> 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0~
    ## $ Calories46   <dbl> 0.78650, 0.78650, 0.78650, 0.78650, 0.78650, 0.78650, 0.7~
    ## $ Calories47   <dbl> 0.78650, 0.78650, 0.78650, 0.78650, 0.78650, 0.78650, 0.7~
    ## $ Calories48   <dbl> 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.9438, 0~
    ## $ Calories49   <dbl> 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0~
    ## $ Calories50   <dbl> 0.9438, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 2~
    ## $ Calories51   <dbl> 2.0449, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 2~
    ## $ Calories52   <dbl> 2.0449, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0~
    ## $ Calories53   <dbl> 0.9438, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0~
    ## $ Calories54   <dbl> 2.3595, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0~
    ## $ Calories55   <dbl> 1.8876, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0~
    ## $ Calories56   <dbl> 0.9438, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0~
    ## $ Calories57   <dbl> 0.9438, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0~
    ## $ Calories58   <dbl> 0.9438, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0~
    ## $ Calories59   <dbl> 0.9438, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 2~

``` r
minitue_calories <- mutate(minitue_calories, 
               Id = as.character(Id),
               ActivityHour = ymd_hms(as.POSIXct(ActivityHour, format="%m/%d/%Y %I:%M:%S %p", tz = "UTC")),
               )

minitue_calories <- rename(
  minitue_calories,
  user_id = Id,
  activity_hour = ActivityHour,
)

minitue_calories <- minitue_calories %>% distinct()

glimpse(minitue_calories)
```

    ## Rows: 21,645
    ## Columns: 62
    ## $ user_id       <chr> "1503960366", "1503960366", "1503960366", "1503960366", ~
    ## $ activity_hour <dttm> 2016-04-13 00:00:00, 2016-04-13 01:00:00, 2016-04-13 02~
    ## $ Calories00    <dbl> 1.8876, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories01    <dbl> 2.2022, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories02    <dbl> 0.9438, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories03    <dbl> 0.9438, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories04    <dbl> 0.9438, 0.9438, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories05    <dbl> 2.0449, 0.9438, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories06    <dbl> 0.9438, 0.9438, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories07    <dbl> 2.2022, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories08    <dbl> 0.9438, 0.9438, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories09    <dbl> 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories10    <dbl> 0.9438, 0.9438, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories11    <dbl> 0.78650, 0.78650, 0.78650, 2.04490, 0.78650, 0.78650, 0.~
    ## $ Calories12    <dbl> 0.78650, 0.94380, 0.78650, 0.94380, 0.78650, 0.78650, 0.~
    ## $ Calories13    <dbl> 0.78650, 0.78650, 0.78650, 0.78650, 0.78650, 0.78650, 0.~
    ## $ Calories14    <dbl> 0.78650, 0.78650, 0.78650, 0.78650, 0.78650, 0.78650, 0.~
    ## $ Calories15    <dbl> 0.9438, 0.7865, 0.7865, 0.9438, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories16    <dbl> 0.9438, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories17    <dbl> 0.7865, 0.7865, 0.7865, 0.9438, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories18    <dbl> 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories19    <dbl> 0.7865, 0.7865, 0.7865, 0.7865, 0.9438, 0.9438, 0.7865, ~
    ## $ Calories20    <dbl> 1.88760, 0.78650, 0.78650, 0.78650, 0.78650, 0.78650, 0.~
    ## $ Calories21    <dbl> 0.94380, 0.78650, 0.78650, 0.78650, 0.78650, 0.78650, 0.~
    ## $ Calories22    <dbl> 0.94380, 0.78650, 0.78650, 0.78650, 0.78650, 0.78650, 0.~
    ## $ Calories23    <dbl> 0.9438, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories24    <dbl> 0.9438, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories25    <dbl> 2.0449, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories26    <dbl> 2.3595, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories27    <dbl> 0.9438, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories28    <dbl> 2.0449, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories29    <dbl> 0.9438, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories30    <dbl> 0.9438, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories31    <dbl> 0.9438, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories32    <dbl> 2.0449, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories33    <dbl> 1.8876, 0.7865, 0.7865, 0.9438, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories34    <dbl> 0.9438, 0.7865, 0.7865, 2.0449, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories35    <dbl> 0.7865, 0.7865, 0.7865, 2.0449, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories36    <dbl> 0.7865, 0.7865, 0.7865, 1.8876, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories37    <dbl> 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories38    <dbl> 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories39    <dbl> 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories40    <dbl> 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.9438, ~
    ## $ Calories41    <dbl> 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.9438, ~
    ## $ Calories42    <dbl> 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories43    <dbl> 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.9438, ~
    ## $ Calories44    <dbl> 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories45    <dbl> 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories46    <dbl> 0.78650, 0.78650, 0.78650, 0.78650, 0.78650, 0.78650, 0.~
    ## $ Calories47    <dbl> 0.78650, 0.78650, 0.78650, 0.78650, 0.78650, 0.78650, 0.~
    ## $ Calories48    <dbl> 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.9438, ~
    ## $ Calories49    <dbl> 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories50    <dbl> 0.9438, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories51    <dbl> 2.0449, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories52    <dbl> 2.0449, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories53    <dbl> 0.9438, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories54    <dbl> 2.3595, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories55    <dbl> 1.8876, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories56    <dbl> 0.9438, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories57    <dbl> 0.9438, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories58    <dbl> 0.9438, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, ~
    ## $ Calories59    <dbl> 0.9438, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, 0.7865, ~

``` r
minitue_calories %>% select(user_id) %>% distinct()
```

    ## # A tibble: 33 x 1
    ##    user_id   
    ##    <chr>     
    ##  1 1503960366
    ##  2 1624580081
    ##  3 1644430081
    ##  4 1844505072
    ##  5 1927972279
    ##  6 2022484408
    ##  7 2026352035
    ##  8 2320127002
    ##  9 2347167796
    ## 10 2873212765
    ## # ... with 23 more rows

``` r
minitue_calories %>% filter(is.na(user_id))
```

    ## # A tibble: 0 x 62
    ## # ... with 62 variables: user_id <chr>, activity_hour <dttm>, Calories00 <dbl>,
    ## #   Calories01 <dbl>, Calories02 <dbl>, Calories03 <dbl>, Calories04 <dbl>,
    ## #   Calories05 <dbl>, Calories06 <dbl>, Calories07 <dbl>, Calories08 <dbl>,
    ## #   Calories09 <dbl>, Calories10 <dbl>, Calories11 <dbl>, Calories12 <dbl>,
    ## #   Calories13 <dbl>, Calories14 <dbl>, Calories15 <dbl>, Calories16 <dbl>,
    ## #   Calories17 <dbl>, Calories18 <dbl>, Calories19 <dbl>, Calories20 <dbl>,
    ## #   Calories21 <dbl>, Calories22 <dbl>, Calories23 <dbl>, Calories24 <dbl>, ...

``` r
minitue_calories %>% filter(is.na(activity_hour))
```

    ## # A tibble: 0 x 62
    ## # ... with 62 variables: user_id <chr>, activity_hour <dttm>, Calories00 <dbl>,
    ## #   Calories01 <dbl>, Calories02 <dbl>, Calories03 <dbl>, Calories04 <dbl>,
    ## #   Calories05 <dbl>, Calories06 <dbl>, Calories07 <dbl>, Calories08 <dbl>,
    ## #   Calories09 <dbl>, Calories10 <dbl>, Calories11 <dbl>, Calories12 <dbl>,
    ## #   Calories13 <dbl>, Calories14 <dbl>, Calories15 <dbl>, Calories16 <dbl>,
    ## #   Calories17 <dbl>, Calories18 <dbl>, Calories19 <dbl>, Calories20 <dbl>,
    ## #   Calories21 <dbl>, Calories22 <dbl>, Calories23 <dbl>, Calories24 <dbl>, ...

-   33 unique user ids

## Save files

``` r
write_csv(minitue_calories, output_file)
file.move(output_file, cleaned_data_path, overwrite = TRUE)
```

    ## 1 file moved. 0 failed.
